\section{Server}
\label{sec:server}

The server exists to create a link between the database and the quiz program,
as well creating connections with, and processing requests from, clients.

\subsection{System Design}
\label{sub:system_design}

\begin{enumerate}
	\item \textbf{Initialising the server}

	When the server starts, a \texttt{QuizServer} object is created. The object
	creates a connection with the database, which allows the server object to
	retrieve, and update, information contained in the database.  In addition
	to this, a \texttt{ServerSocket} object is created, which waits to receive
	connections from \texttt{QuizClient} objects. When a connection from a
	client is received, a new \texttt{ClientThread} object is created.

	\item \textbf{Database Connectivity}

	The server interacts with the database through static methods contained in
	the \texttt{QuizJDBC} class.  The class allows the server to establish a
	connection with the database through a \texttt{getConnection} method, which
	returns a Connection object.

	A second method, \texttt{isUser}, is called by the server when it receives
	a \texttt{LoginRequest} object from a client thread. The method returns a
	\texttt{LoginReply} object containing the results of the query, which is
	sent to the client.

	The final method, \texttt{getQuiz}, is called when the server receives a
	\texttt{QuizRequest} object from a client, and returns a \texttt{Quiz}
	object.

	\item \textbf{\texttt{ClientThread} Objects}

	When the server establishes a connection with a client, a
	\texttt{ClientThread} object is created, spawning a thread which allows
	interactions to occur between the server and  client. The server then waits
	to receive a \texttt{LoginRequest} from the client, and returns a
	\texttt{LoginReply} object upon receiving it.  Once the client has logged in,
	the server distinguishes between student and Admin users.

	\item \textbf{Admin Clients}

	If a connection to an Admin has been made, the server waits for a
	\texttt{QuizRequest} object. Once received, the server updates a static
	boolean variable, which informs all connected clients that a \texttt{Quiz}
	object has been created, and the quiz is started.

	\item \textbf{Student Client}

	Once a quiz has been started, the server sends a \texttt{Quiz} object to
	all connected clients, and then waits to receive an \texttt{AnswerReponse}
	from each of the student client threads. The \texttt{AnswerReposnse}
	objects contain the clients response to a question, and the time that it
	took for them to answer it.  The server than calculates the clients score,
	and the results are stored in an ArrayList, which contains the results of
	all connected student clients.  This ArrayList of scores is then sent to
	the connected clients at the end of each question.

\end{enumerate}
